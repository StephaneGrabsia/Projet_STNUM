nbclust(cleaned_data[c(1:200),c(3:10,12:14)], distance = "euclidean", method = "average")
fviz_nbclust(cleaned_data[c(1:200),c(3:10,12:14)], FUNcluster = hcut, method = "silhouette",hc_method = "average", hc_metric = "euclidean", stand = TRUE)
library(NbClust)
NbClust(cleaned_data[c(1:200),c(3:10,12:14)], distance = "euclidean", method = "average")
fviz_nbclust(cleaned_data[c(1:1000),c(3:10,12:14)], FUNcluster = hcut, method = "silhouette",hc_method = "average", hc_metric = "euclidean", stand = TRUE)
library(NbClust)
NbClust(cleaned_data[c(1:1000),c(3:10,12:14)], distance = "euclidean", method = "average")
cah_ward <- agnes(cleaned_data[c(1:1000),c(3:10,12:14)],metric="euclidean",stand=TRUE,method="ward")
plot(as.dendrogram(cah_ward),main="Ward")
ei <- data.frame(k=2:dim(cleaned_data[c(1:1000),c(3:10,12:14)])[1],height=sort(cah_ward$height,decreasing=TRUE))
ggplot(data=ei,aes(x=k,y=height))+
geom_bar(stat="identity",fill="steelblue")+
theme_minimal()+
ggtitle("Gain d'inertie inter-classes lors du passage de (k-1) à k classes")+
xlab("k")+
ylab("Indice d'aggrégation")+
scale_x_continuous(breaks=2:dim(cleaned_data[c(1:1000),c(3:10,12:14)])[1])
plot(as.dendrogram(cah_ward),main="Ward")
rect.hclust(cah_ward,k=2)
cluster_ward_2cl <- data.frame(nom=rownames(cleaned_data[c(1:1000),c(3:10,12:14)]),classe=cutree(cah_ward,k=2))
cluster_ward_3cl[order(cluster_ward_3cl$classe),]
plot(as.dendrogram(cah_ward),main="Ward")
rect.hclust(cah_ward,k=2)
cluster_ward_2cl <- data.frame(nom=rownames(cleaned_data[c(1:1000),c(3:10,12:14)]),classe=cutree(cah_ward,k=2))
cluster_ward_2cl[order(cluster_ward_3cl$classe),]
plot(as.dendrogram(cah_ward),main="Ward")
rect.hclust(cah_ward,k=2)
cluster_ward_2cl <- data.frame(nom=rownames(cleaned_data[c(1:1000),c(3:10,12:14)]),classe=cutree(cah_ward,k=2))
cluster_ward_2cl[order(cluster_ward_2cl$classe),]
View(cleaned_data)
View(cleaned_data)
data
data[data$vitamin.a_100g>20]
data[data$vitamin.a_100g>20,]
a = data[data$vitamin.a_100g>20,]
View(a)
View(a)
a = data[data$vitamin.a_100g>10,]
a = data[data$vitamin.a_100g>5,]
cleaned_data = data[ (data$vitamin.c_100g<100) & (data$energy.kcal_100g<1000) & (data$proteins_100g<100) & (data$sugars_100g < 80) & (data$fat_100g < 100) & (data$saturated.fat_100g < 100) & (data$fiber_100g <100) & (data$salt_100g < 100) & (data$sodium_100g <10) & (data$vitamin.a_100g < 100) & (data$calcium_100g < 10), ]
#ggpairs(data[c(3:13)])
gradient_col <- ggplot2::scale_fill_gradient2(
low = "blue", high = "red",
midpoint = 0.5, limits = c(0, 1)
)
heatmaply_cor(
cor(cleaned_data[c(3:14)]),
scale_fill_gradient=gradient_col,
cellnote=round(cor(cleaned_data[c(3:14)]),2),
cellnote_color = "auto",
cellnote_textposition = "middle center",
cellnote_size = 6,
show_dendrogram=c(FALSE,FALSE),
)
cah_ward <- agnes(cleaned_data[c(1:1000),c(3:10,12:14)],metric="euclidean",stand=TRUE,method="ward")
plot(as.dendrogram(cah_ward),main="Ward")
ei <- data.frame(k=2:dim(cleaned_data[c(1:1000),c(3:10,12:14)])[1],height=sort(cah_ward$height,decreasing=TRUE))
ggplot(data=ei,aes(x=k,y=height))+
geom_bar(stat="identity",fill="steelblue")+
theme_minimal()+
ggtitle("Gain d'inertie inter-classes lors du passage de (k-1) à k classes")+
xlab("k")+
ylab("Indice d'aggrégation")+
scale_x_continuous(breaks=2:dim(cleaned_data[c(1:1000),c(3:10,12:14)])[1])
plot(as.dendrogram(cah_ward),main="Ward")
rect.hclust(cah_ward,k=2)
cluster_ward_2cl <- data.frame(nom=rownames(cleaned_data[c(1:1000),c(3:10,12:14)]),classe=cutree(cah_ward,k=2))
cluster_ward_2cl[order(cluster_ward_2cl$classe),]
library(GGally)
library(ggplot2)
library(FactoMineR)
library(cluster)
library(factoextra)
library(heatmaply)
library(dplyr)
library(tidyr)
data <-read.csv("data_project.csv", sep=";")
print(data)
cleaned_data = data[ (data$vitamin.c_100g<100) & (data$energy.kcal_100g<1000) & (data$proteins_100g<100) & (data$sugars_100g < 80) & (data$fat_100g < 100) & (data$saturated.fat_100g < 100) & (data$fiber_100g <100) & (data$salt_100g < 100) & (data$sodium_100g <10) & (data$vitamin.a_100g < 100) & (data$calcium_100g < 10), ]
#ggpairs(data[c(3:13)])
gradient_col <- ggplot2::scale_fill_gradient2(
low = "blue", high = "red",
midpoint = 0.5, limits = c(0, 1)
)
heatmaply_cor(
cor(cleaned_data[c(3:14)]),
scale_fill_gradient=gradient_col,
cellnote=round(cor(cleaned_data[c(3:14)]),2),
cellnote_color = "auto",
cellnote_textposition = "middle center",
cellnote_size = 6,
show_dendrogram=c(FALSE,FALSE),
)
data_of_interest = data[c(3:5)]
hist(as.double(data_of_interest$energy.kcal_100g),freq=TRUE,xlab="Energy in kcal for 100g",main="Histogramme", breaks = 100)
hist(as.double(data_of_interest$proteins_100g),freq=TRUE,xlab="Proteins for 100g",main="Histogramme", breaks = 100)
hist(as.double(data_of_interest$sugars_100g),freq=TRUE,xlab="Sugars for 100g",main="Histogramme", breaks = 100)
plot(ecdf(data_of_interest$energy.kcal_100g),main="Energy")
plot(ecdf(data_of_interest$proteins_100g),main="Proteins")
plot(ecdf(data_of_interest$sugars_100g),main="Sugar")
boxplot(data_of_interest[,c("energy.kcal_100g")],main="Boites à moustaches des trois variables")
boxplot(data_of_interest[,c("proteins_100g","sugars_100g")],main="Boites à moustaches des trois variables")
mytable <- table(data$nutriscore_grade)
options(digits=4)
percentage <- round(100*mytable/sum(mytable),digits = 2)
lbls <- paste(names(mytable), "\n", percentage, "%", sep="")
pie(mytable, labels = lbls,
main="Nutriscore grade repartition")
sapply(cleaned_data[c(3:14)], var)
out_acp <- PCA(cleaned_data[,c(3:10, 12:14)],scale.unit=TRUE,ncp=11,graph=FALSE)
summary(out_acp)
val_prop <- out_acp$eig[,"eigenvalue"]
cp <- 1:length(val_prop)
vp <- data.frame(cp=cp,val_prop=val_prop)
ggplot(data=vp,aes(x=cp,y=val_prop, fill=val_prop))+
geom_bar(stat="identity", width = 0.7)+
ggtitle("Eboulis des valeurs propres")+
xlab("Nombre de composantes principales")+
ylab("Valeurs propres")+
scale_x_continuous(breaks=cp)
fviz_eig(out_acp, addlabels = TRUE, ylim = c(0, 50), barfill = "navyblue",
barcolor = "navyblue" ,linecolor = "black" , hjust=0)
plot.PCA(out_acp,shadow=TRUE,cex=0.8,axes=c(1,2),choix="var",new.plot=TRUE,
title="Cercle des corrélations", gradient.cols = c("blue", "red"),)
fviz_pca_var(out_acp, axes = c(1,2),
col.var = "cos2",
gradient.cols = c("navyblue","blue"),
repel = TRUE)
fviz_pca_var(out_acp, axes = c(2,3),
col.var = "cos2",
gradient.cols = c("navyblue","blue"),
repel = TRUE)
fviz_pca_var(out_acp, axes = c(1,3),
col.var = "cos2",
gradient.cols = c("navyblue","blue"),
repel = TRUE)
plot.PCA(out_acp,shadow=TRUE,cex=2,axes=c(1,2),choix="ind",label="none",new.plot=TRUE, title="Projection des individus")
cah_ward <- agnes(cleaned_data[c(1:1000),c(3:10,12:14)],metric="euclidean",stand=TRUE,method="ward")
plot(as.dendrogram(cah_ward),main="Ward")
ei <- data.frame(k=2:dim(cleaned_data[c(1:1000),c(3:10,12:14)])[1],height=sort(cah_ward$height,decreasing=TRUE))
ggplot(data=ei,aes(x=k,y=height))+
geom_bar(stat="identity",fill="steelblue")+
theme_minimal()+
ggtitle("Gain d'inertie inter-classes lors du passage de (k-1) à k classes")+
xlab("k")+
ylab("Indice d'aggrégation")+
scale_x_continuous(breaks=2:dim(cleaned_data[c(1:1000),c(3:10,12:14)])[1])
plot(as.dendrogram(cah_ward),main="Ward")
rect.hclust(cah_ward,k=2)
cluster_ward_2cl <- data.frame(nom=rownames(cleaned_data[c(1:1000),c(3:10,12:14)]),classe=cutree(cah_ward,k=2))
cluster_ward_2cl[order(cluster_ward_2cl$classe),]
fviz_nbclust(cleaned_data[c(1:1000),c(3:10,12:14)], FUNcluster = hcut, method = "silhouette",hc_method = "average", hc_metric = "euclidean", stand = TRUE)
library(NbClust)
NbClust(cleaned_data[c(1:1000),c(3:10,12:14)], distance = "euclidean", method = "average")
View(cleaned_data)
View(cleaned_data)
View(cleaned_data)
View(cleaned_data)
View(cleaned_data)
View(cleaned_data)
library(FactoMineR)
library(factoextra)
library(cluster)
data_nor <- scale(cleaned_data[,c(3:10,12:14)],center=TRUE,scale=TRUE)
cluster_kmeans_3cl <- kmeans(data_nor,centers=5,nstart=20)
print(cluster_kmeans_3cl)
fviz_cluster(cluster_kmeans_3cl, cleaned_data[,c(3:10,12:14)],palette = c("#009999", "#0000FF", "#FF2400", "#FF6EC7", "#6D071A"))
cleaned_data = data[ (data$vitamin.c_100g<100) & (data$energy.kcal_100g<1000) & (data$proteins_100g<100) & (data$sugars_100g < 80) & (data$fat_100g < 100) & (data$saturated.fat_100g < 100) & (data$fiber_100g <100) & (data$salt_100g < 100) & (data$sodium_100g <100) & (data$vitamin.a_100g < 10) & (data$calcium_100g < 10), ]
#ggpairs(data[c(3:13)])
gradient_col <- ggplot2::scale_fill_gradient2(
low = "blue", high = "red",
midpoint = 0.5, limits = c(0, 1)
)
heatmaply_cor(
cor(cleaned_data[c(3:14)]),
scale_fill_gradient=gradient_col,
cellnote=round(cor(cleaned_data[c(3:14)]),2),
cellnote_color = "auto",
cellnote_textposition = "middle center",
cellnote_size = 6,
show_dendrogram=c(FALSE,FALSE),
)
cah_ward <- agnes(cleaned_data[c(1:1000),c(3:10,12:14)],metric="euclidean",stand=TRUE,method="ward")
plot(as.dendrogram(cah_ward),main="Ward")
ei <- data.frame(k=2:dim(cleaned_data[c(1:1000),c(3:10,12:14)])[1],height=sort(cah_ward$height,decreasing=TRUE))
ggplot(data=ei,aes(x=k,y=height))+
geom_bar(stat="identity",fill="steelblue")+
theme_minimal()+
ggtitle("Gain d'inertie inter-classes lors du passage de (k-1) à k classes")+
xlab("k")+
ylab("Indice d'aggrégation")+
scale_x_continuous(breaks=2:dim(cleaned_data[c(1:1000),c(3:10,12:14)])[1])
plot(as.dendrogram(cah_ward),main="Ward")
rect.hclust(cah_ward,k=2)
cluster_ward_2cl <- data.frame(nom=rownames(cleaned_data[c(1:1000),c(3:10,12:14)]),classe=cutree(cah_ward,k=2))
cluster_ward_2cl[order(cluster_ward_2cl$classe),]
data[data$sodium_100g>50]
a=data[data$sodium_100g>50,]
a=data[data$sodium_100g>49,]
a=data[data$salt_100g>49,]
a=data[data$sodium_100g>20,]
a=data[data$sodium_100g>"219",]
a=data[data$sodium_100g>19,]
cleaned_data = data[ (data$vitamin.c_100g<100) & (data$energy.kcal_100g<1000) & (data$proteins_100g<100) & (data$sugars_100g < 80) & (data$fat_100g < 100) & (data$saturated.fat_100g < 100) & (data$fiber_100g <100) & (data$salt_100g < 100) & (data$sodium_100g <100) & (data$sodium_100g>19) & (data$vitamin.a_100g < 10) & (data$calcium_100g < 10), ]
#ggpairs(data[c(3:13)])
gradient_col <- ggplot2::scale_fill_gradient2(
low = "blue", high = "red",
midpoint = 0.5, limits = c(0, 1)
)
heatmaply_cor(
cor(cleaned_data[c(3:14)]),
scale_fill_gradient=gradient_col,
cellnote=round(cor(cleaned_data[c(3:14)]),2),
cellnote_color = "auto",
cellnote_textposition = "middle center",
cellnote_size = 6,
show_dendrogram=c(FALSE,FALSE),
)
cleaned_data = data[ (data$vitamin.c_100g<100) & (data$energy.kcal_100g<1000) & (data$proteins_100g<100) & (data$sugars_100g < 80) & (data$fat_100g < 100) & (data$saturated.fat_100g < 100) & (data$fiber_100g <100) & (data$salt_100g < 100) & (data$sodium_100g <20) & (data$vitamin.a_100g < 10) & (data$calcium_100g < 10), ]
#ggpairs(data[c(3:13)])
gradient_col <- ggplot2::scale_fill_gradient2(
low = "blue", high = "red",
midpoint = 0.5, limits = c(0, 1)
)
heatmaply_cor(
cor(cleaned_data[c(3:14)]),
scale_fill_gradient=gradient_col,
cellnote=round(cor(cleaned_data[c(3:14)]),2),
cellnote_color = "auto",
cellnote_textposition = "middle center",
cellnote_size = 6,
show_dendrogram=c(FALSE,FALSE),
)
cah_ward <- agnes(cleaned_data[c(1:1000),c(3:10,12:14)],metric="euclidean",stand=TRUE,method="ward")
plot(as.dendrogram(cah_ward),main="Ward")
ei <- data.frame(k=2:dim(cleaned_data[c(1:1000),c(3:10,12:14)])[1],height=sort(cah_ward$height,decreasing=TRUE))
ggplot(data=ei,aes(x=k,y=height))+
geom_bar(stat="identity",fill="steelblue")+
theme_minimal()+
ggtitle("Gain d'inertie inter-classes lors du passage de (k-1) à k classes")+
xlab("k")+
ylab("Indice d'aggrégation")+
scale_x_continuous(breaks=2:dim(cleaned_data[c(1:1000),c(3:10,12:14)])[1])
plot(as.dendrogram(cah_ward),main="Ward")
rect.hclust(cah_ward,k=2)
cluster_ward_2cl <- data.frame(nom=rownames(cleaned_data[c(1:1000),c(3:10,12:14)]),classe=cutree(cah_ward,k=2))
cluster_ward_2cl[order(cluster_ward_2cl$classe),]
a=data[data$vitamin.c_100g>0.5]
a=data[data$vitamin.c_100g>0.5,]
a=data[data$vitamin.c_100g>0.6,]
a=data[data$fiber_100g>49,]
View(a)
data_for_cluster <- sample(x = 1:len(cleaned_data), size = 5000)
data_for_cluster <- sample(x = 1:size(cleaned_data), size = 5000)
data_for_cluster <- sample(x = 1:lenght(cleaned_data), size = 5000)
data_for_cluster <- sample(x = 1:length(cleaned_data), size = 5000)
data_for_cluster <- sample(x = 1:nrow(cleaned_data), size = 5000)
vec <- sample(x = 1:nrow(cleaned_data), size = 5000)
data_for_cluster <- cleaned_data[c(vec),c(3:10,12:14)]
View(data_for_cluster)
cah_ward <- agnes(data_for_cluster,metric="euclidean",stand=TRUE,method="ward")
plot(as.dendrogram(cah_ward),main="Ward")
ei <- data.frame(k=2:dim(cleaned_data[c(1:5000),c(3:10,12:14)])[1],height=sort(cah_ward$height,decreasing=TRUE))
ggplot(data=ei,aes(x=k,y=height))+
geom_bar(stat="identity",fill="steelblue")+
theme_minimal()+
ggtitle("Gain d'inertie inter-classes lors du passage de (k-1) à k classes")+
xlab("k")+
ylab("Indice d'aggrégation")+
scale_x_continuous(breaks=2:dim(cleaned_data[c(1:5000),c(3:10,12:14)])[1])
library(GGally)
library(ggplot2)
library(FactoMineR)
library(cluster)
library(factoextra)
library(heatmaply)
library(dplyr)
library(tidyr)
data <-read.csv("data_project.csv", sep=";")
print(data)
cleaned_data = data[ (data$vitamin.c_100g<100) & (data$energy.kcal_100g<1000) & (data$proteins_100g<100) & (data$sugars_100g < 80) & (data$fat_100g < 100) & (data$saturated.fat_100g < 100) & (data$fiber_100g <100) & (data$salt_100g < 100) & (data$sodium_100g <20) & (data$vitamin.a_100g < 10) & (data$calcium_100g < 10), ]
#ggpairs(data[c(3:13)])
gradient_col <- ggplot2::scale_fill_gradient2(
low = "blue", high = "red",
midpoint = 0.5, limits = c(0, 1)
)
heatmaply_cor(
cor(cleaned_data[c(3:14)]),
scale_fill_gradient=gradient_col,
cellnote=round(cor(cleaned_data[c(3:14)]),2),
cellnote_color = "auto",
cellnote_textposition = "middle center",
cellnote_size = 6,
show_dendrogram=c(FALSE,FALSE),
)
data_of_interest = data[c(3:5)]
hist(as.double(data_of_interest$energy.kcal_100g),freq=TRUE,xlab="Energy in kcal for 100g",main="Histogramme", breaks = 100)
hist(as.double(data_of_interest$proteins_100g),freq=TRUE,xlab="Proteins for 100g",main="Histogramme", breaks = 100)
hist(as.double(data_of_interest$sugars_100g),freq=TRUE,xlab="Sugars for 100g",main="Histogramme", breaks = 100)
plot(ecdf(data_of_interest$energy.kcal_100g),main="Energy")
plot(ecdf(data_of_interest$proteins_100g),main="Proteins")
plot(ecdf(data_of_interest$sugars_100g),main="Sugar")
boxplot(data_of_interest[,c("energy.kcal_100g")],main="Boites à moustaches des trois variables")
boxplot(data_of_interest[,c("proteins_100g","sugars_100g")],main="Boites à moustaches des trois variables")
mytable <- table(data$nutriscore_grade)
options(digits=4)
percentage <- round(100*mytable/sum(mytable),digits = 2)
lbls <- paste(names(mytable), "\n", percentage, "%", sep="")
pie(mytable, labels = lbls,
main="Nutriscore grade repartition")
sapply(cleaned_data[c(3:14)], var)
out_acp <- PCA(cleaned_data[,c(3:10, 12:14)],scale.unit=TRUE,ncp=11,graph=FALSE)
summary(out_acp)
val_prop <- out_acp$eig[,"eigenvalue"]
cp <- 1:length(val_prop)
vp <- data.frame(cp=cp,val_prop=val_prop)
ggplot(data=vp,aes(x=cp,y=val_prop, fill=val_prop))+
geom_bar(stat="identity", width = 0.7)+
ggtitle("Eboulis des valeurs propres")+
xlab("Nombre de composantes principales")+
ylab("Valeurs propres")+
scale_x_continuous(breaks=cp)
fviz_eig(out_acp, addlabels = TRUE, ylim = c(0, 50), barfill = "navyblue",
barcolor = "navyblue" ,linecolor = "black" , hjust=0)
plot.PCA(out_acp,shadow=TRUE,cex=0.8,axes=c(1,2),choix="var",new.plot=TRUE,
title="Cercle des corrélations", gradient.cols = c("blue", "red"),)
fviz_pca_var(out_acp, axes = c(1,2),
col.var = "cos2",
gradient.cols = c("navyblue","blue"),
repel = TRUE)
fviz_pca_var(out_acp, axes = c(2,3),
col.var = "cos2",
gradient.cols = c("navyblue","blue"),
repel = TRUE)
fviz_pca_var(out_acp, axes = c(1,3),
col.var = "cos2",
gradient.cols = c("navyblue","blue"),
repel = TRUE)
plot.PCA(out_acp,shadow=TRUE,cex=2,axes=c(1,2),choix="ind",label="none",new.plot=TRUE, title="Projection des individus")
vec <- sample(x = 1:nrow(cleaned_data), size = 2000)
data_for_cluster <- cleaned_data[c(vec),c(3:10,12:14)]
cah_ward <- agnes(data_for_cluster,metric="euclidean",stand=TRUE,method="ward")
plot(as.dendrogram(cah_ward),main="Ward")
ei <- data.frame(k=2:dim(data_for_cluster)[1],height=sort(cah_ward$height,decreasing=TRUE))
ggplot(data=ei,aes(x=k,y=height))+
geom_bar(stat="identity",fill="steelblue")+
theme_minimal()+
ggtitle("Gain d'inertie inter-classes lors du passage de (k-1) à k classes")+
xlab("k")+
ylab("Indice d'aggrégation")+
scale_x_continuous(breaks=2:dim(data_for_cluster)[1])
plot(as.dendrogram(cah_ward),main="Ward")
rect.hclust(cah_ward,k=2)
cluster_ward_2cl <- data.frame(nom=rownames(data_for_cluster),classe=cutree(cah_ward,k=2))
cluster_ward_2cl[order(cluster_ward_2cl$classe),]
fviz_nbclust(data_for_cluster, FUNcluster = hcut, method = "silhouette",hc_method = "average", hc_metric = "euclidean", stand = TRUE)
library(NbClust)
NbClust(data_for_cluster, distance = "euclidean", method = "average")
library(GGally)
library(ggplot2)
library(FactoMineR)
library(cluster)
library(factoextra)
library(heatmaply)
library(dplyr)
library(tidyr)
data <-read.csv("data_project.csv", sep=";")
print(data)
set.seed(10)
cleaned_data = data[ (data$vitamin.c_100g<100) & (data$energy.kcal_100g<1000) & (data$proteins_100g<100) & (data$sugars_100g < 80) & (data$fat_100g < 100) & (data$saturated.fat_100g < 100) & (data$fiber_100g <100) & (data$salt_100g < 100) & (data$sodium_100g <20) & (data$vitamin.a_100g < 10) & (data$calcium_100g < 10), ]
#ggpairs(data[c(3:13)])
gradient_col <- ggplot2::scale_fill_gradient2(
low = "blue", high = "red",
midpoint = 0.5, limits = c(0, 1)
)
heatmaply_cor(
cor(cleaned_data[c(3:14)]),
scale_fill_gradient=gradient_col,
cellnote=round(cor(cleaned_data[c(3:14)]),2),
cellnote_color = "auto",
cellnote_textposition = "middle center",
cellnote_size = 6,
show_dendrogram=c(FALSE,FALSE),
)
data_of_interest = data[c(3:5)]
hist(as.double(data_of_interest$energy.kcal_100g),freq=TRUE,xlab="Energy in kcal for 100g",main="Histogramme", breaks = 100)
hist(as.double(data_of_interest$proteins_100g),freq=TRUE,xlab="Proteins for 100g",main="Histogramme", breaks = 100)
hist(as.double(data_of_interest$sugars_100g),freq=TRUE,xlab="Sugars for 100g",main="Histogramme", breaks = 100)
plot(ecdf(data_of_interest$energy.kcal_100g),main="Energy")
plot(ecdf(data_of_interest$proteins_100g),main="Proteins")
plot(ecdf(data_of_interest$sugars_100g),main="Sugar")
boxplot(data_of_interest[,c("energy.kcal_100g")],main="Boites à moustaches des trois variables")
boxplot(data_of_interest[,c("proteins_100g","sugars_100g")],main="Boites à moustaches des trois variables")
mytable <- table(data$nutriscore_grade)
options(digits=4)
percentage <- round(100*mytable/sum(mytable),digits = 2)
lbls <- paste(names(mytable), "\n", percentage, "%", sep="")
pie(mytable, labels = lbls,
main="Nutriscore grade repartition")
sapply(cleaned_data[c(3:14)], var)
out_acp <- PCA(cleaned_data[,c(3:10, 12:14)],scale.unit=TRUE,ncp=11,graph=FALSE)
summary(out_acp)
val_prop <- out_acp$eig[,"eigenvalue"]
cp <- 1:length(val_prop)
vp <- data.frame(cp=cp,val_prop=val_prop)
ggplot(data=vp,aes(x=cp,y=val_prop, fill=val_prop))+
geom_bar(stat="identity", width = 0.7)+
ggtitle("Eboulis des valeurs propres")+
xlab("Nombre de composantes principales")+
ylab("Valeurs propres")+
scale_x_continuous(breaks=cp)
fviz_eig(out_acp, addlabels = TRUE, ylim = c(0, 50), barfill = "navyblue",
barcolor = "navyblue" ,linecolor = "black" , hjust=0)
plot.PCA(out_acp,shadow=TRUE,cex=0.8,axes=c(1,2),choix="var",new.plot=TRUE,
title="Cercle des corrélations", gradient.cols = c("blue", "red"),)
fviz_pca_var(out_acp, axes = c(1,2),
col.var = "cos2",
gradient.cols = c("navyblue","blue"),
repel = TRUE)
fviz_pca_var(out_acp, axes = c(2,3),
col.var = "cos2",
gradient.cols = c("navyblue","blue"),
repel = TRUE)
fviz_pca_var(out_acp, axes = c(1,3),
col.var = "cos2",
gradient.cols = c("navyblue","blue"),
repel = TRUE)
plot.PCA(out_acp,shadow=TRUE,cex=2,axes=c(1,2),choix="ind",label="none",new.plot=TRUE, title="Projection des individus")
vec <- sample(x = 1:nrow(cleaned_data), size = 2000)
data_for_cluster <- cleaned_data[c(vec),c(3:10,12:14)]
fviz_nbclust(data_for_cluster, FUNcluster = hcut, method = "silhouette",hc_method = "average", hc_metric = "euclidean", stand = TRUE)
library(NbClust)
NbClust(data_for_cluster, distance = "euclidean", method = "average")
cah_ward <- agnes(data_for_cluster,metric="euclidean",stand=TRUE,method="ward")
plot(as.dendrogram(cah_ward),main="Ward")
ei <- data.frame(k=2:dim(data_for_cluster)[1],height=sort(cah_ward$height,decreasing=TRUE))
ggplot(data=ei,aes(x=k,y=height))+
geom_bar(stat="identity",fill="steelblue")+
theme_minimal()+
ggtitle("Gain d'inertie inter-classes lors du passage de (k-1) à k classes")+
xlab("k")+
ylab("Indice d'aggrégation")+
scale_x_continuous(breaks=2:dim(data_for_cluster)[1])
plot(as.dendrogram(cah_ward),main="Ward")
rect.hclust(cah_ward,k=4)
cluster_ward_2cl <- data.frame(nom=rownames(data_for_cluster),classe=cutree(cah_ward,k=4))
cluster_ward_2cl[order(cluster_ward_2cl$classe),]
library(FactoMineR)
library(factoextra)
library(cluster)
data_nor <- scale(cleaned_data[,c(3:10,12:14)],center=TRUE,scale=TRUE)
cluster_kmeans_3cl <- kmeans(data_nor,centers=5,nstart=20)
print(cluster_kmeans_3cl)
fviz_cluster(cluster_kmeans_3cl, cleaned_data[,c(3:10,12:14)],palette = c("#009999", "#0000FF", "#FF2400", "#FF6EC7", "#6D071A"))
plot(as.dendrogram(cah_ward),main="Ward")
rect.hclust(cah_ward,k=5)
cluster_ward_2cl <- data.frame(nom=rownames(data_for_cluster),classe=cutree(cah_ward,k=5))
cluster_ward_2cl[order(cluster_ward_2cl$classe),]
plot(as.dendrogram(cah_ward),main="Ward")
rect.hclust(cah_ward,k=5)
cluster_ward_2cl <- data.frame(nom=rownames(data_for_cluster),classe=cutree(cah_ward,k=5))
cluster_ward_2cl[order(cluster_ward_2cl$classe),]
library(FactoMineR)
library(factoextra)
library(cluster)
data_nor <- scale(cleaned_data[,c(3:10,12:14)],center=TRUE,scale=TRUE)
cluster_kmeans_5cl <- kmeans(data_nor,centers=5,nstart=20)
print(cluster_kmeans_5cl)
fviz_cluster(cluster_kmeans_5cl, cleaned_data[,c(3:10,12:14)],palette = c("#009999", "#0000FF", "#FF2400", "#FF6EC7", "#6D071A"))
cluster_ward_2cl$size
a=data[data$]
a=data[data$vitamin.a_100g>0.1,]
View(a)
a=cleaned_data[cleaned_data$vitamin.a_100g>0.1,]
View(a)
cleaned_data = data[ (data$vitamin.c_100g<100) & (data$energy.kcal_100g<1000) & (data$proteins_100g<100) & (data$sugars_100g < 80) & (data$fat_100g < 100) & (data$saturated.fat_100g < 100) & (data$fiber_100g <100) & (data$salt_100g < 100) & (data$sodium_100g <20) & (data$vitamin.a_100g < 0.12) & (data$calcium_100g < 10), ]
#ggpairs(data[c(3:13)])
gradient_col <- ggplot2::scale_fill_gradient2(
low = "blue", high = "red",
midpoint = 0.5, limits = c(0, 1)
)
heatmaply_cor(
cor(cleaned_data[c(3:14)]),
scale_fill_gradient=gradient_col,
cellnote=round(cor(cleaned_data[c(3:14)]),2),
cellnote_color = "auto",
cellnote_textposition = "middle center",
cellnote_size = 6,
show_dendrogram=c(FALSE,FALSE),
)
cleaned_data = data[ (data$vitamin.c_100g<100) & (data$energy.kcal_100g<1000) & (data$proteins_100g<100) & (data$sugars_100g < 80) & (data$fat_100g < 100) & (data$saturated.fat_100g < 100) & (data$fiber_100g <100) & (data$salt_100g < 100) & (data$sodium_100g <20) & (data$vitamin.a_100g < 0.12) & (data$calcium_100g < 10), ]
#ggpairs(data[c(3:13)])
gradient_col <- ggplot2::scale_fill_gradient2(
low = "blue", high = "red",
midpoint = 0.5, limits = c(0, 1)
)
heatmaply_cor(
cor(cleaned_data[c(3:14)]),
scale_fill_gradient=gradient_col,
cellnote=round(cor(cleaned_data[c(3:14)]),2),
cellnote_color = "auto",
cellnote_textposition = "middle center",
cellnote_size = 6,
show_dendrogram=c(FALSE,FALSE),
)
library(FactoMineR)
library(factoextra)
library(cluster)
data_nor <- scale(cleaned_data[,c(3:10,12:14)],center=TRUE,scale=TRUE)
cluster_kmeans_5cl <- kmeans(data_nor,centers=5,nstart=20)
print(cluster_kmeans_5cl)
fviz_cluster(cluster_kmeans_5cl, cleaned_data[,c(3:10,12:14)],palette = c("#009999", "#0000FF", "#FF2400", "#FF6EC7", "#6D071A"))
